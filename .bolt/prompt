# SAFETY RAIL â€” DIABOT V4 (KHÃ”NG Äá»¤NG UI/UX)

âŒ TUYá»†T Äá»I KHÃ”NG Sá»¬A/XOÃ:
- src/interfaces/ui/screens/Dashboard.tsx
- src/interfaces/ui/styles/globals.css
- src/app/layout.tsx
- Táº¤T Cáº¢ tokens.css, tailwind.config.{js,ts}
- Táº¤T Cáº¢ form Ä‘Ã£ hoÃ n thiá»‡n (BG/Water/Insulin/â€¦)
=> Náº¿u cáº§n sá»­a cÃ¡c file trÃªn: Dá»ªNG, liá»‡t kÃª lÃ½ do vÃ  CHá»œ TÃ”I DUYá»†T.

âœ… CHá»ˆ ÄÆ¯á»¢C PHÃ‰P Sá»¬A (ná»n táº£ng Ä‘á»ƒ cháº¡y AI):
1) Fix import alias:
   - src/modules/bp/infrastructure/adapters/BPRepo.supabase.ts
   - src/modules/weight/infrastructure/adapters/WeightRepo.supabase.ts
   => Chuáº©n hoÃ¡ direct import tá»›i src/lib/supabase/client

2) Táº¡o unified Supabase client:
   - src/lib/supabase/client.ts (single source of truth)

3) HoÃ n thiá»‡n component tá»‘i thiá»ƒu (náº¿u thiáº¿u):
   - src/interfaces/ui/components/atoms/Toast.tsx (success/error)
   - src/interfaces/ui/components/atoms/Input.tsx (size variants)
   - (Chá»‰ 2 file nÃ y, KHÃ”NG chá»‰nh cÃ¡c component/atoms khÃ¡c)

4) (TÃ™Y CHá»ŒN, CHá»ˆ KHI Cáº¦N) helper nhá»:
   - src/lib/utils.ts  (thÃªm hÃ m thuáº§n cho AI; khÃ´ng Ä‘Æ°á»£c import UI)

5) Táº¡o placeholder AI Gateway:
   - src/app/api/ai/gateway/route.ts (Next.js)
   - Chá»‰ stub: nháº­n {idempotency_key,user_id,intent,message} â†’ 200 "OK: stub"

âš™ï¸ QUY TRÃŒNH THá»°C HIá»†N Báº®T BUá»˜C
- BÆ°á»›c 0: TRÆ¯á»šC KHI GHI FILE â†’ Xuáº¥t danh sÃ¡ch file sáº½ sá»­a (diff preview ngáº¯n).
- BÆ°á»›c 1: Chá» tÃ´i CONFIRM, rá»“i má»›i ghi.
- BÆ°á»›c 2: Sau khi ghi â†’ In checklist test nhanh (node scripts hoáº·c curl).

ğŸ§ª KIá»‚M THá»¬ SAU KHI Sá»¬A
- Build khÃ´ng lá»—i import.
- curl POST /api/ai/gateway tráº£ 200 "OK: stub".
- Toast hiá»ƒn thá»‹ lá»—i/thÃ nh cÃ´ng (demo story/preview).
- KHÃ”NG cÃ³ thay Ä‘á»•i trong Dashboard.tsx, globals.css, layout, tokens, tailwind.

ğŸ“¦ BÃ€N GIAO
- Danh sÃ¡ch file Ä‘Ã£ sá»­a.
- MÃ£ nguá»“n + ghi chÃº 1â€“2 dÃ²ng má»—i thay Ä‘á»•i.
- Lá»‡nh test cURL vÃ  npm script (náº¿u cÃ³).